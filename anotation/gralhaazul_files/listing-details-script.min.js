$(document).ready(function(){function a(a){var e="R$ "+(1*a).toFixed(2).replace(/\./,",").replace(/\d(?=(\d{3})+\,)/g,"$&.");return e}function e(a){var e=(100*a).toFixed(2).replace(/\./,",").replace(/\d(?=(\d{3})+\,)/g,"$&.")+"%";return e}function o(){var a=$("#valor_imovel").val();a=a.replace("R$",""),a=a.replace(/\./g,"");var e=$("#valor_financiado").val();e=e.replace("R$",""),e=e.replace(/\./g,"");var o=parseFloat(a)-parseFloat(e),i=o.toFixed(2);i=i.replace(".",",");var t=$("#prazo").val(),s=$("#idade").val(),r="",l=$("#valor_imovel").val(),c=$("#valor_financiado").val();$(".form-financimento .valor_do_imovel_contato").attr("value",l),$(".form-financimento .entrada_contato").attr("value",c),$(".form-financimento .prazo_contato").attr("value",t+" meses"),$(".form-financimento .idade_contato").attr("value",s+" anos"),$.ajax({url:"/api/offices",dataType:"json",beforeSend:function(){$(".message-capital").remove(),$("<div class='box-inner text-xs-center loading-capital message-capital'><i class='fa fa-spinner fa-spin fa-lg fa-fw'></i><span class='sr-only'>Loading...</span></div>").appendTo(".ingaia-capital")},success:function(e){var o=e[0].cid;r="https://www.gaiacredito.com.br/common/get_financing?id_referencia=VG_1&idcorr=83412&id_estado=1&tipo_imovel=1&condicao_imovel=1&simular=1&valor_imovel="+a+"&valor_financiado="+i+"&prazo="+t+"&idade="+s+"&canal_portal=7&idimob="+o+"&consorcio=1",$.ajax({timeout:3e4,url:r,type:"GET",dataType:"jsonp",onFailure:function(a){timeOut()},success:function(a){n(a)}})}})}function n(o){var i=$("#valor_financiado").val(),n=$("#prazo").val(),t=999999999999,t=999999999999;if(o.simulacao)var s=e(o.simulacao.lfs[0].taxa),r=e(o.simulacao.lfs[0].cet),t=o.simulacao.lfs[0].parc1;if(o.consorcio)var l=o.consorcio.parcela;if($(".tx_anual").html(s),$(".cet_anual").html(r),o.simulacao||o.consorcio){var c="";c+="<div class='box-result-capital text-xs-center message-capital'>",o.consorcio&&(c+="<div class='col-xs-12 col-md-6 result result01'>",c+="<h2>Consórcio</h2>",c+="<p class='info-text'>Grupo com objetivo em comum. Contemplação antecipada por sorteio ou lance.</p>",c+="<div class='valor-box'>",c+="<p><i class='fa fa-check'></i><span>"+a(o.consorcio.parcela)+"</span><br>SEM ENTRADA</p>",c+="</div>",c+="<div class='valor-table'>",c+="<p class='hidden-md-down'>Seguro (opcional)<br> <strong>"+a(o.consorcio.seguro_prestamista)+"</strong></p>",c+="<p>Oferta de lance<br> <strong>"+a(o.consorcio.oferta_lance)+"</strong></p>",c+="<p>Renda mensal<br> <strong>"+a(o.consorcio.renda_mensal)+"</strong></p>",c+="<p>Prazo<br> <strong>"+o.consorcio.prazo+" meses</strong></p>",c+="<p class='hidden-sm-down'><a href='javascript:;' class='more-info' data-toggle='modal' data-target='#more-info-consorcio'><i class='fa fa-question-circle'></i><span class='hidden-md-down'><br>Saiba mais</a></span></p>",c+="</div>",c+="<input type='hidden' id='id_simulacao' name='id_simulacao' value='"+o.consorcio.id_simulacao+"'>",c+="<button type='button' class='btn btn-lg btn-success' data-toggle='modal' data-target='#i-want-consorcio'>Quero assessoria gratuita</button>",c+="</div>"),o.simulacao&&(c+="<div class='col-xs-12 col-md-6 result result02'>",c+="<h2>Financiamento</h2>",c+="<p class='info-text'>Retirada imediata após análise de crédito e toda a documentação</p>",c+="<div class='valor-box'>",c+="<p><i class='fa fa-check'></i><span>"+a(o.simulacao.lfs[0].parc1)+"</span><br>1º parcela</p>",c+="</div>",c+="<div class='valor-table'>",c+="<p class='hidden-md-down'>Última parcela<br> <strong>"+a(o.simulacao.lfs[0].parcn)+"</strong></p>",c+="<p>Entrada<br> <strong>"+i+"</strong></p>",c+="<p>Renda mensal<br> <strong>"+a(o.simulacao.lfs[0].renda)+"</strong></p>",c+="<p>Prazo<br> <strong>"+n+" meses</strong></p>",c+="<p class='hidden-sm-down'><a href='javascript:;' class='more-info' data-toggle='modal' data-target='#more-info-financiamento'><i class='fa fa-question-circle'></i><span class='hidden-md-down'><br>Saiba mais</span></a></p>",c+="</div>",c+="</div>"),c+="</div>",c+="<div class='message-capital'>",c+="<div class='info text-xs-center'>",c+="<p class='logo-capital'>Ferramenta desenvolvida por: <img src='https://ingaiasites.s3.amazonaws.com/assets/img/gaiacredito.png'><img src='https://ingaiasites.s3.amazonaws.com/assets/img/gaiacredito-white.png' class='img-dark'></p>",c+="<p class='obs'>IMPORTANTE: Os resultados no presente website não constituem qualquer forma de proposta financeira bem como não vinculam quaisquer partes e/ou instituições financeiras anunciadas, tratando-se apenas de simulações não vinculantes, que podem variar de acordo com a idade e o perfil do proponente. A formalização do crédito e financiamento estão sujeitos à análise a aprovações de crédito, a serem realizadas de forma independente pelas respectivas instituições financeiras. As condições anunciadas poderão ser alteradas e/ou extintas pelas respectivas instituições financeiras a qualquer momento e sem prévio aviso.</p>",c+="</div>",c+="</div>",$(".message-capital").remove(),$("#modal-result .modal-body").html(c)}else $(".message-capital").remove(),$("#modal-result .modal-body").html("<div style='margin: 15px' class='alert alert-danger alert-dismissible fade in' role='alert'><button type='button' class='close' data-dismiss='alert' aria-label='Close'><span aria-hidden='true'>&times;</span></button>"+o.msg+"</div>");$(".result").removeClass("melhor"),t>l?$(".result01").addClass("melhor"):$(".result02").addClass("melhor")}function t(a){if(a=a.replace(/[^\d]+/g,""),""==a)return!1;if(11!=a.length||"00000000000"==a||"11111111111"==a||"22222222222"==a||"33333333333"==a||"44444444444"==a||"55555555555"==a||"66666666666"==a||"77777777777"==a||"88888888888"==a||"99999999999"==a)return!1;for(add=0,i=0;i<9;i++)add+=parseInt(a.charAt(i))*(10-i);if(rev=11-add%11,10!=rev&&11!=rev||(rev=0),rev!=parseInt(a.charAt(9)))return!1;for(add=0,i=0;i<10;i++)add+=parseInt(a.charAt(i))*(11-i);return rev=11-add%11,10!=rev&&11!=rev||(rev=0),rev==parseInt(a.charAt(10))}$(".form-details-contact-box form").validate(),$(".form-details-contact-modal form").validate(),$(".form-ingaia-capital input.form-control").each(function(){var a=$(this).attr("data-value");$(this).hasClass("currency")&&(a=parseInt(a,10).toFixed(2)),$(this).val(a)}),$(".form-ingaia-capital").validate({errorElement:"span",submitHandler:function(){var a=$("#idade").val(),e=$("#prazo").val(),i=12*a;return i=parseInt(i)+parseInt(e),i>966?($(".alert").remove(),$('<div class="alert alert-danger alert-dismissible fade in" role="alert"><button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>A soma da idade e prazo máximo para a contratação de um financiamento imobiliário é de 80 anos e 6 meses.</div>').appendTo(".message-alert"),!1):(o(),$("#modal-simulator").modal("hide"),setTimeout(function(){$("#modal-result").modal("show")},1e3),$("#modal-result .modal-body").html("<div class='text-xs-center loading-capital message-capital'><i class='fa fa-spinner fa-spin fa-lg fa-fw' /><span class='sr-only'>Loading...</span></div>"),!1)}}),$.validator.addMethod("minAge",function(a,e){return a=$.trim(a),!(a<18)&&(this.optional(e)||!0)},"A idade mínima para a contratação de um financiamento imobiliário é de 18 anos.");var s="";$.validator.addMethod("prazo",function(a,e){return $.validator.messages.prazo=s,a<24?(s="O prazo mínimo para a contratação de um financiamento imobiliário é de 24 meses.",!1):a>360?(s="O prazo máximo para a contratação de um financiamento imobiliário é de 360 meses.",!1):this.optional(e)||!0},s);const r=function(a){try{var e=a.replace("R$","");return e=e.replace(".","").replace(".",""),parseFloat(.3*e)}catch(a){return 0}},l=$("#valor_imovel").val(),c=r(l);$("#valor_financiado").val(c);const d=$(".form-ingaia-capital");setTimeout(function(){d.find(".currency").maskMoney({prefix:"R$ ",allowNegative:!0,thousands:".",decimal:",",precision:2}),d.find(".currency").maskMoney("mask"),$("#valor_imovel").attr("disabled","disabled")},100),$(".form-ingaia-capital-contact").validate({errorElement:"span",submitHandler:function(){var a=$("#id_simulacao").val(),e=$("#nome_cliente").val(),o=$("#email").val(),i=$("#telefone").val(),n=$("#renda").val(),s=window.location.href,r=s,l=$("#cpf").val(),c=t(l);return 1!=c?($(".form-ingaia-capital-contact .cpf").after("<span id='nome-error' class='error'>Por favor, informe um CPF válido</span>"),$(".form-ingaia-capital-contact .cpf").addClass("error"),!1):($(".form-ingaia-capital-contact button").html("<i class='fa fa-spinner fa-spin fa-lg fa-fw'></i>"),$(".form-ingaia-capital-contact button").attr("disabled","disabled"),$(".message-alert .alert-danger").remove(),$.ajax({url:"/api/offices",dataType:"json",success:function(t){var s=t[0].cid;$.ajax({type:"GET",dataType:"jsonp",timeout:3e4,url:"https://www.gaiacredito.com.br/common/add_financing_consortium",data:{id_simulacao:a,nome_cliente:e,email:o,telefone:i,renda:n,idimob_filial:s,site:r,cpf:l},onFailure:function(a){timeOut()},success:function(a){return $("#i-want-consorcio .modal-body").html("<div class='row'><div class='col-xs-12 text-xs-center'><h3>Obrigado</h3><p>Em até 24 horas*, um consultor entrará em contato com você.</p><br></div></div>"),!1}})}}),!1)}}),$("#more").click(function(){"Veja mais"===$(this).html()?($(".table-striped").removeClass("hide-value"),$(this).html("Veja menos")):"Veja menos"===$(this).html()&&($(".table-striped").addClass("hide-value"),$(this).html("Veja mais"))}),$("#more-info-consorcio").on("hidden.bs.modal",function(a){$("body").addClass("modal-open")}),$("#more-info-financiamento").on("hidden.bs.modal",function(a){$("body").addClass("modal-open")}),$("#i-want-consorcio").on("hidden.bs.modal",function(a){$("body").addClass("modal-open")}),$(".form-financimento").validate({errorElement:"span",submitHandler:function(){return $(".form-financimento button").html("<i class='fa fa-spinner fa-spin fa-lg fa-fw'></i>"),$(".form-financimento button").attr("disabled","disabled"),$.ajax({type:"POST",data:$(".form-financimento").serialize(),timeout:3e4,url:"/financiamento-e-bancos",beforeSend:function(){},onFailure:function(a){alert("Não foi")},success:function(a){return $(".form-contato-financiamento").html("<h5>Obrigado</h5><p>Recebemos sua mensagem! Em breve entraremos em contato.</p>"),!1}}),!1}})});